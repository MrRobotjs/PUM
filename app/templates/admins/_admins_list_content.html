<!-- File: app/templates/admins/_admins_list_content.html -->
<div class="card bg-base-200 shadow-xl">
    <div class="card-body">
        <h2 class="card-title">Existing Admins</h2>
        <div class="overflow-x-auto">
            <table class="table">
                <thead>
                    <tr><th>ID</th><th>Username</th><th>Type / Linked Account</th><th>Permissions</th><th>Actions</th></tr>
                </thead>
                <tbody>
                {% for admin in admins %}
                <tr class="hover">
                    <td>{{ admin.id }}</td>
                    <td>{{ admin.username or 'Plex SSO Only' }}</td>
                    <td>{% if admin.plex_username %}<i class="fa-brands fa-plex"></i> {{ admin.plex_username }}{% else %}Local{% endif %}</td>
                    <td>
                        {% if admin.id == 1 %} 
                            <span class="badge badge-success">Super Admin</span>
                        {% else %}
                            {% for p in admin.permissions %}
                                <span class="badge badge-ghost badge-sm">{{ p | replace('_', ' ')|title }}</span>
                            {% else %}
                                <span class="badge badge-ghost badge-sm">None</span>
                            {% endfor %}
                        {% endif %}
                    </td>
                    <td class="space-x-1">
                    {% if admin.id != current_user.id and admin.id != 1 %} {# Cannot delete self or super admin #}
                        <a href="{{ url_for('admins.edit_admin', admin_id=admin.id) }}" class="btn btn-xs btn-outline">Edit</a>
                        <form action="{{ url_for('admins.delete_admin', admin_id=admin.id) }}" method="POST" class="inline" onsubmit="return confirm('Are you sure you want to delete this admin?');">
                            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                            <button type="submit" class="btn btn-xs btn-error">Delete</button>
                        </form>
                    {% endif %}
                    </td>
                </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>